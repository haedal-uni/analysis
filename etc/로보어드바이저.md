# 로보어드바이저

## 로보어드바이저란?

> **사람 대신 자동으로 투자 결정을 내려주는 시스템**

### 왜 사용하는가?
- 인간의 감정 개입 없이 **객관적이고 일관된 투자 판단** 가능
- 수많은 데이터를 빠르게 처리하여 **효율적인 투자 전략** 실행 가능
- 초보 투자자도 **간단한 규칙 기반 투자**로 접근 가능

### 로보어드바이저의 종류

| 유형         | 설명                                                                           |
|--------------|----------------------------------------------------------------------------------|
| **규칙 기반**   | 조건(룰)에 맞춰 자동 투자 (예: PER<10, ROE>15)                                 |
| **통계 기반**   | 과거 통계를 활용하여 종목 필터링 또는 매매 전략 결정 (예: 이동 평균 전략 등)             |
| **AI 기반**     | 머신러닝, 딥러닝 등 인공지능 기법을 활용하여 자동 학습 후 투자 판단 (복잡하고 정교함)     |


---

## 기본 전략 소개 및 비교

| 전략명         | 설명                                     | 장점                              | 단점                          |
|----------------|------------------------------------------|-----------------------------------|-------------------------------|
| **전일 변화율** | 오늘과 어제의 가격 차이를 기준으로 판단         | 빠르게 반응 (단기 감지 가능)         | **노이즈**에 민감 (헛신호가 많음)     |
| **이동 평균**   | 일정 기간 동안의 평균 가격을 계산하여 추세 판단  | 추세에 따라 안정적인 매매 가능        | 신호가 **느릴 수 있음**            |

### 용어 설명
- **노이즈**: 큰 의미 없이 단기적으로 발생하는 가격의 흔들림
- **추세 기반**: 장기적인 흐름(상승/하락 추세)에 따라 매매하는 전략

### 전략 차이점 요약표

| 관점           | 전일 변화율 전략                     | 이동 평균 전략                          |
|----------------|-------------------------------------|----------------------------------------|
| **전략 목적**     | 단기 가격 변화 감지                    | 큰 흐름(추세) 판단                      |
| **장점**        | 빠르고 간단                           | 비교적 안정적인 추세 기반 판단 가능         |
| **약점**        | 헛신호 발생 가능성 있음                 | 신호가 느림 (타이밍 놓칠 수 있음)            |
| **사용 예시**     | 급등/급락 포착 (스캘핑 전략 등)            | 골든크로스, 데드크로스 활용 (중기 추세 전략)     |

---

## 골든크로스 vs 데드크로스

> **골든크로스**: 단기 이동 평균선이 장기 이동 평균선을 위로 돌파 → **상승 신호 (매수)**
>
> **데드크로스**: 단기 이동 평균선이 장기 이동 평균선을 아래로 돌파 → **하락 신호 (매도)**

```text
   가격
     ▲
     |     o o o o   ← 5일 평균 (단기)
     |   o        o
     |  o          o
     | o             o ← 20일 평균 (장기)
     +----------------------▶ 날짜
```

---

## `diff()`와 `position` 개념

```py
signal = [0, 0, 1, 1, 0, -1, -1, 0]
position = signal.diff()
```

| 일자 | signal | diff() = position | 의미          |
|------|--------|-------------------|-----------------|
| 1    | 0      | NaN               | 없음            |
| 2    | 0      | 0                 | 유지            |
| 3    | 1      | 1                 | **매수 시작**     |
| 4    | 1      | 0                 | 보유 상태 유지     |
| 5    | 0      | -1                | **매도 시작**     |
| 6    | -1     | -1                | 계속 매도 상태     |
| 7    | -1     | 0                 | 매도 유지         |
| 8    | 0      | 1                 | **보유로 전환**     |

> `diff()`는 값의 변화만을 보여주기 때문에 매수/매도 시점을 파악하는 데 유용하다.

---

## 로보어드바이저 예제 코드: 골든/데드 크로스 전략

```py
import pandas as pd
import yfinance as yf
import matplotlib.pyplot as plt

# 1. 데이터 불러오기
symbol = 'AAPL'
stock = yf.download(symbol, start='2023-01-01', end='2024-01-01')

# 2. 이동 평균 계산
stock['MA5'] = stock['Close'].rolling(window=5).mean()
stock['MA20'] = stock['Close'].rolling(window=20).mean()

# 3. 매매 신호 생성
stock['signal'] = 0
stock.loc[stock['MA5'] > stock['MA20'], 'signal'] = 1
stock.loc[stock['MA5'] < stock['MA20'], 'signal'] = -1
stock['position'] = stock['signal'].diff()

# 4. 시각화
plt.figure(figsize=(14, 6))
plt.plot(stock['Close'], label='Close Price')
plt.plot(stock['MA5'], label='MA5')
plt.plot(stock['MA20'], label='MA20')
plt.plot(stock[stock['position'] == 1].index,
         stock['MA5'][stock['position'] == 1], '^', color='g', label='Buy Signal')
plt.plot(stock[stock['position'] == -1].index,
         stock['MA5'][stock['position'] == -1], 'v', color='r', label='Sell Signal')
plt.legend()
plt.title(f"{symbol} 골든/데드 크로스 전략")
plt.show()
```

---

## 로보어드바이저 예제 2: 전일 변화율 기반 전략

```py
import pandas as pd

# CSV 데이터 불러오기
# 날짜, 종가, 거래량 등의 컬럼 포함된 CSV 파일 필요

# 전처리
# '변동 %'와 '거래량' 등 문자열 수치형 변환 필요

# 전일 종가 대비 변화율 계산 후 신호 생성
def trading_signal(df, threshold=1.0):
    df['변화율'] = df['종가'].pct_change() * 100
    df['신호'] = df['변화율'].apply(lambda x: '매수' if x >= threshold else ('매도' if x <= -threshold else '보유'))
    return df[['종가', '변화율', '신호']]
```

---

## 포트폴리오 분산 전략이란?

> **여러 자산(종목)에 나누어 투자함으로써 리스크를 줄이는 전략**

### 왜 분산하는가?
- 하나의 종목이 손실을 보더라도 다른 종목이 이를 상쇄 가능
- 전체 포트폴리오의 안정성 향상

### 예시 전략 (Equal Weight)
```py
# 3개 종목에 동일 비중 투자
portfolio = {
    'AAPL': 0.33,
    'MSFT': 0.33,
    'GOOGL': 0.34
}
```

---

## 백테스트란?

> **과거 데이터를 기준으로 전략을 테스트하는 작업**

### 왜 하는가?
- 전략의 유효성을 과거 데이터로 미리 점검 가능
- 실전 투자 전에 리스크를 줄이는 안전망 역할

### 백테스트 간단 예제
```py
initial_cash = 1000000
cash = initial_cash
position = 0

for date, row in df.iterrows():
    if row['신호'] == '매수' and position == 0:
        position = cash / row['종가']
        cash = 0
    elif row['신호'] == '매도' and position > 0:
        cash = position * row['종가']
        position = 0

final_value = cash + position * df.iloc[-1]['종가']
print(f"최종 수익률: {(final_value / initial_cash - 1) * 100:.2f}%")
```

---

## 전체 요약

- **전일 변화율 전략**: 빠른 대응 가능하지만 노이즈에 민감함
- **이동 평균 전략**: 추세에 따른 안정적인 매매 가능, 다만 느릴 수 있음
- **골든크로스/데드크로스**: 대표적인 이동 평균 기반 전략
- **로보어드바이저**: 규칙 기반 → 통계 기반 → AI 기반으로 다양하게 발전 중
- **포트폴리오 분산**: 리스크를 줄이기 위한 필수 전략
- **백테스트**: 과거 데이터를 활용한 전략 테스트 필수 절차


